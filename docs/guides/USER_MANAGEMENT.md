# Управление пользователями

## Вход в систему

### Десктопная версия
Запустите приложение через `run.bat` или `python main.py`

**Учетные данные по умолчанию:**
- Логин: `admin`
- Пароль: `admin`

### Веб-версия
1. Запустите сервер: `python start_server.py`
2. Откройте браузер: `http://localhost:8000`
3. Войдите с теми же учетными данными:
   - Логин: `admin`
   - Пароль: `admin`

## Управление пользователями

Для добавления, изменения или удаления пользователей используйте скрипт `manage_users.py`:

```bash
python manage_users.py
```

### Доступные операции:

#### 1. Показать всех пользователей
Выводит список всех пользователей с их ролями и статусом активности.

#### 2. Добавить пользователя
Создает нового пользователя. Потребуется ввести:
- Логин (уникальный)
- Пароль
- Роль (выбрать из списка)

#### 3. Изменить пароль
Изменяет пароль существующего пользователя.

#### 4. Изменить роль
Изменяет роль пользователя.

#### 5. Активировать/Деактивировать пользователя
Включает или отключает доступ пользователя к системе без удаления учетной записи.

## Роли пользователей

### 1. Администратор
- Полный доступ ко всем функциям системы
- Управление справочниками
- Просмотр и редактирование всех документов
- Проведение документов

### 2. Руководитель
- Просмотр и редактирование всех документов
- Проведение документов
- Просмотр аналитики
- Не может управлять системными настройками

### 3. Бригадир
- Создание и редактирование своих смет
- Создание и редактирование своих нарядов
- Просмотр аналитики по своим данным
- Не может управлять справочниками

### 4. Исполнитель (Сотрудник)
- Только просмотр смет
- Просмотр нарядов, где является исполнителем
- Просмотр своей аналитики
- Не может создавать или редактировать документы

## Примеры использования

### Создание нового бригадира
```
python manage_users.py
> 2 (Добавить пользователя)
> Логин: ivanov
> Пароль: password123
> Роль: 3 (Бригадир)
```

### Изменение пароля
```
python manage_users.py
> 3 (Изменить пароль)
> Логин пользователя: ivanov
> Новый пароль: newpassword456
```

### Деактивация пользователя
```
python manage_users.py
> 5 (Активировать/Деактивировать)
> Логин пользователя: ivanov
```

## Важные замечания

1. **Безопасность паролей**: Все пароли хранятся в виде bcrypt-хешей и не могут быть восстановлены. Если пользователь забыл пароль, администратор должен установить новый.

2. **Синхронизация**: Изменения, сделанные через `manage_users.py`, сразу применяются как для десктопной, так и для веб-версии.

3. **Связь с физическими лицами**: Для ролей "Бригадир" и "Исполнитель" рекомендуется создать соответствующую запись в справочнике "Физические лица" и связать её с пользователем через поле `user_id`.

4. **Первый запуск**: При первом запуске системы автоматически создается пользователь `admin` с паролем `admin`. Рекомендуется сразу изменить этот пароль.

## Устранение проблем

### Не могу войти в десктопную версию
1. Убедитесь, что используете правильный логин и пароль
2. Проверьте, что пользователь активен (через `manage_users.py` → пункт 1)
3. Если забыли пароль, сбросьте его через `manage_users.py` → пункт 3

### Не могу войти в веб-версию
1. Убедитесь, что сервер запущен (`python start_server.py`)
2. Проверьте URL: должен быть `http://localhost:8000`
3. Используйте те же учетные данные, что и для десктопной версии

### Пользователь не видит свои документы
1. Проверьте роль пользователя
2. Для бригадиров: убедитесь, что в справочнике "Физические лица" есть запись с `user_id`, соответствующим ID пользователя
3. Для исполнителей: убедитесь, что они добавлены как исполнители в нарядах
