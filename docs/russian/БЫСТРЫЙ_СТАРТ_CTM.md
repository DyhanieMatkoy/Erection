# Быстрый старт - Обновление web-клиента

## Что изменилось?

### 1. Новый адрес web-приложения
Теперь приложение работает по адресу: **http://servut.npksarmat.ru/ctm/**

### 2. Групповые операции
В списках документов можно выбирать несколько документов и выполнять операции сразу над всеми:
- ✅ Удалить несколько документов
- ✅ Провести несколько документов (администраторы)
- ✅ Отменить проведение (администраторы)

## Как использовать групповые операции?

### Шаг 1: Откройте список документов
Например: Сметы, Ежедневные отчеты или Табели

### Шаг 2: Выберите документы
- Кликните на чекбокс слева от нужных документов
- Или выберите все на странице через чекбокс в заголовке

### Шаг 3: Выполните операцию
Появятся кнопки:
- **Провести (N)** - зеленая кнопка
- **Отменить проведение (N)** - желтая кнопка
- **Удалить (N)** - красная кнопка

### Шаг 4: Подтвердите
Подтвердите операцию в диалоговом окне

## Развертывание на сервере

### Вариант 1: Быстрое обновление (Windows)
```batch
build_web.bat
```

### Вариант 2: Полное развертывание (Linux)
```bash
# 1. Соберите приложение
cd web-client
npm install
npm run build
cd ..

# 2. Скопируйте на сервер
sudo cp -r web-client/dist/* /var/www/construction-app/

# 3. Обновите конфигурацию nginx
sudo cp deploy-to-prod/nginx-ctm.conf /etc/nginx/sites-available/construction-app
sudo ln -s /etc/nginx/sites-available/construction-app /etc/nginx/sites-enabled/

# 4. Перезагрузите nginx
sudo nginx -t
sudo systemctl reload nginx
```

## Проверка работы

1. Откройте браузер
2. Перейдите на http://servut.npksarmat.ru/ctm/
3. Войдите в систему
4. Откройте список смет
5. Попробуйте выбрать несколько документов
6. Проверьте, что появились кнопки групповых операций

## Важные замечания

### Ограничения групповых операций:
- ❌ Нельзя удалить проведенные документы
- ❌ Проведение и отмена проведения - только для администраторов
- ⚠️ Рекомендуется не более 50 документов за раз

### Безопасность:
- Все операции требуют авторизации
- Проведение документов - только администраторы
- Нельзя удалить проведенные документы

## Откат изменений

Если что-то пошло не так:

1. Откройте `web-client/vite.config.ts`
2. Удалите строку `base: '/ctm/',`
3. Откройте `web-client/src/router/index.ts`
4. Измените на `createWebHistory(import.meta.env.BASE_URL)`
5. Пересоберите: `build_web.bat`

## Помощь

### Проблемы с доступом?
- Проверьте, что используете `/ctm/` в конце адреса
- Очистите кеш браузера (Ctrl+Shift+Del)
- Проверьте логи nginx: `sudo tail -f /var/log/nginx/construction-app-error.log`

### Групповые операции не работают?
- Убедитесь, что вы администратор (для проведения)
- Проверьте, что документы не проведены (для удаления)
- Проверьте консоль браузера (F12 → Console)

### API не отвечает?
- Проверьте, что API запущен: `sudo systemctl status construction-api`
- Проверьте логи: `journalctl -u construction-api -f`

## Дополнительная документация

- `WEB_CLIENT_CTM_DEPLOYMENT.md` - полная инструкция по развертыванию
- `web-client/CTM_BASE_PATH_SETUP.md` - настройка базового пути
- `web-client/BULK_OPERATIONS_GUIDE.md` - подробное руководство по групповым операциям
- `CHANGELOG_CTM_BULK_OPS.md` - список всех изменений

## Контакты

При возникновении проблем обратитесь к системному администратору.
