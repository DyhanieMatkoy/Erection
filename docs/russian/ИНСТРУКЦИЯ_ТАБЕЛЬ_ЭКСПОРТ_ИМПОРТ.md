# Инструкция: Экспорт и импорт документа Табель

## Обзор

Документ "Табель учета рабочего времени" поддерживает экспорт и импорт данных в форматах Excel и JSON. Это позволяет:
- Создавать печатные формы для отчетности
- Обмениваться данными между системами
- Заполнять табель из внешних источников
- Создавать резервные копии данных

## Экспорт табеля

### Экспорт в Excel

1. Откройте документ Табель
2. Нажмите кнопку **"Экспорт в Excel"**
3. Выберите место сохранения файла
4. Нажмите **"Сохранить"**

**Результат:** Создается файл Excel с печатной формой, содержащей:
- Заголовок с номером документа
- Реквизиты документа (дата, период, объект, смета, прораб)
- Таблицу с сотрудниками и отработанными часами по дням месяца
- Итоговые суммы

### Экспорт в JSON

1. Откройте документ Табель
2. Нажмите кнопку **"Экспорт в JSON"**
3. Выберите место сохранения файла
4. Нажмите **"Сохранить"**

**Результат:** Создается JSON файл со структурированными данными для программного обмена.

## Импорт табеля

### ⚠️ Важные ограничения

- Импорт возможен только в **несохраненные** или **непроведенные** документы
- При импорте **все существующие данные** в табличной части будут заменены
- Сотрудники должны существовать в базе данных (поиск по ФИО)

### Импорт из Excel

1. Откройте документ Табель (новый или существующий непроведенный)
2. Нажмите кнопку **"Импорт из Excel"**
3. Выберите файл Excel с данными
4. Подтвердите замену данных
5. Дождитесь завершения импорта

**Система автоматически:**
- Найдет сотрудников по ФИО
- Заполнит часы по дням месяца
- Рассчитает итоговые суммы

### Импорт из JSON

1. Откройте документ Табель (новый или существующий непроведенный)
2. Нажмите кнопку **"Импорт из JSON"**
3. Выберите JSON файл с данными
4. Подтвердите замену данных
5. Дождитесь завершения импорта

## Формат Excel файла для импорта

### Структура файла

```
ТАБЕЛЬ УЧЕТА РАБОЧЕГО ВРЕМЕНИ №ТБ-001

Дата документа:    15.12.2024
Период:            12.2024
Объект:            Жилой дом
Смета:             СМ-001
Прораб:            Иванов И.И.
Проведен:          Нет

№  | Сотрудник      | Ставка | 1 | 2 | 3 | ... | 31 | Итого часов | Сумма
---|----------------|--------|---|---|---|-----|----|-----------|---------
1  | Петров П.П.    | 500    | 8 | 8 | 8 | ... | 8  | 160       | 80000
2  | Сидоров С.С.   | 450    | 8 | 8 | 8 | ... | 8  | 160       | 72000
```

### Требования к данным

1. **ФИО сотрудника** должно точно совпадать с данными в справочнике "Физические лица"
2. **Часы** должны быть числовыми значениями (пустые ячейки = 0 часов)
3. **Ставка** должна быть числовым значением

## Настройка отображения помеченных объектов

### Доступ к настройкам

1. Откройте меню **"Настройки"**
2. Выберите **"Удаление помеченных объектов"**

### Настройка отображения

1. Установите флажок **"Отображать помеченные на удаление объекты в списке"**
2. Выберите типы объектов для отображения:
   - ☑ Сметы
   - ☑ Ежедневные отчеты
   - ☑ **Табели**
   - ☑ Контрагенты
   - ☑ Объекты
   - ☑ Организации
   - ☑ Физические лица
   - ☑ Виды работ

3. Нажмите **"Обновить"** для применения настроек

**По умолчанию:** Помеченные объекты скрыты для безопасности данных.

## Типичные сценарии использования

### Сценарий 1: Создание печатной формы

1. Заполните табель в программе
2. Экспортируйте в Excel
3. Откройте файл Excel
4. Распечатайте или отправьте по email

### Сценарий 2: Заполнение из внешнего источника

1. Получите Excel файл с данными о рабочем времени
2. Убедитесь, что ФИО сотрудников совпадают с базой данных
3. Создайте новый документ Табель
4. Заполните реквизиты (объект, смета, период)
5. Сохраните документ
6. Импортируйте данные из Excel
7. Проверьте результат
8. Проведите документ

### Сценарий 3: Резервное копирование

1. Экспортируйте табель в JSON
2. Сохраните файл в безопасном месте
3. При необходимости восстановите данные импортом

## Обработка ошибок

### "Сотрудник не найден в базе данных"

**Причина:** ФИО в Excel файле не совпадает с данными в справочнике

**Решение:**
1. Откройте справочник "Физические лица"
2. Проверьте точное написание ФИО
3. Исправьте данные в Excel файле
4. Повторите импорт

### "Нельзя импортировать данные в проведенный документ"

**Причина:** Документ уже проведен

**Решение:**
1. Отмените проведение документа
2. Выполните импорт
3. Проверьте данные
4. Проведите документ заново

### "Сначала сохраните табель"

**Причина:** Документ еще не сохранен в базе данных

**Решение:**
1. Заполните обязательные реквизиты
2. Нажмите "Сохранить"
3. Выполните импорт

## Часто задаваемые вопросы

### Можно ли импортировать только часть данных?

Нет, импорт заменяет все данные в табличной части. Для частичного обновления используйте ручное редактирование.

### Сохраняются ли старые данные при импорте?

Нет, все существующие строки удаляются перед импортом. Рекомендуется создать резервную копию через экспорт.

### Какой формат лучше использовать?

- **Excel** - для работы с людьми, печатных форм, ручного редактирования
- **JSON** - для программного обмена, автоматизации, резервного копирования

### Можно ли редактировать экспортированный Excel файл?

Да, вы можете редактировать данные в Excel файле перед импортом. Главное - сохранить структуру таблицы и точность ФИО сотрудников.

## Техническая поддержка

При возникновении проблем:
1. Проверьте формат данных в файле
2. Убедитесь, что все сотрудники существуют в базе данных
3. Проверьте, что документ не проведен
4. Обратитесь к администратору системы