# Инструкция: Импорт смет из Excel и печатные формы

## Импорт смет из Excel

### Как импортировать смету:

1. Откройте раздел **"Сметы"** в веб-интерфейсе
2. Нажмите кнопку **"Импорт из Excel"** (рядом с кнопкой "Создать смету")
3. Выберите файл Excel со сметой (формат .xlsx или .xls)
4. Дождитесь завершения импорта
5. Смета автоматически откроется для просмотра и редактирования

### Что импортируется:

- **Заголовок сметы**: номер, дата, заказчик, подрядчик, объект
- **Строки сметы**: работы, количество, единицы измерения, цены, трудозатраты
- **Итоги**: общая сумма и трудоемкость

### Автоматическое создание справочников:

Если в базе данных нет указанных в смете заказчиков, объектов или работ, они будут созданы автоматически.

### Формат Excel файла:

Файл должен содержать:
- Заголовок с информацией о заказчике и подрядчике
- Таблицу с колонками: №, Код, Наименование работ, ЕдИзм, Кол-во, Цена, ТЗ
- Данные о работах и их стоимости

## Печатные формы

### Печать из списка смет:

1. В списке смет найдите нужную смету
2. Нажмите кнопку **"Excel"** для скачивания в формате Excel
3. Или нажмите кнопку **"PDF"** для скачивания в формате PDF
4. Файл автоматически скачается на ваш компьютер

### Печать из формы сметы:

1. Откройте смету для просмотра
2. Нажмите кнопку **"Печать"**
3. В диалоге выберите формат:
   - **PDF (АРСД)** - стандартный формат для печати
   - **Excel** - для редактирования и расчетов
4. Выберите действие:
   - **Скачать** - сохранить файл на компьютер
   - **Открыть** (только для PDF) - открыть в новой вкладке браузера

### Доступные форматы:

#### PDF (АРСД)
- Профессиональный формат для печати
- Соответствует стандартам строительной документации
- Готов для подписания и передачи заказчику

#### Excel
- Удобен для дальнейшего редактирования
- Содержит все формулы и расчеты
- Можно использовать как шаблон для новых смет

## Печать других документов

### Ежедневные отчеты:
- Доступны те же форматы: PDF и Excel
- Печать из списка отчетов или из формы отчета

### Табели учета рабочего времени:
- Доступны те же форматы: PDF и Excel
- Печать из списка табелей или из формы табеля

## Шаблоны печатных форм

Шаблоны хранятся в папке `PrnForms/`:
- `estimate_template.xlsx` - шаблон для смет
- `daily_report_template.xlsx` - шаблон для ежедневных отчетов

Вы можете настроить шаблоны под свои требования, отредактировав эти файлы.

## Устранение проблем

### Ошибка при импорте:
- Проверьте формат файла (должен быть .xlsx или .xls)
- Убедитесь, что файл содержит таблицу с работами
- Проверьте, что в файле есть заголовок с названием сметы

### Ошибка при печати:
- Убедитесь, что смета сохранена
- Проверьте, что все обязательные поля заполнены
- Попробуйте другой формат (PDF или Excel)

### Файл не скачивается:
- Проверьте настройки браузера (разрешены ли скачивания)
- Попробуйте другой браузер
- Проверьте место на диске

## Технические требования

- Современный браузер (Chrome, Firefox, Edge, Safari)
- Включенный JavaScript
- Разрешение на скачивание файлов
- Для просмотра PDF: встроенный просмотрщик браузера или Adobe Reader

## Поддержка

При возникновении проблем обратитесь к администратору системы.
