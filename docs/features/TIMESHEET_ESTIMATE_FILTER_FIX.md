# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–º–µ—Ç –≤ —Ñ–æ—Ä–º–µ —Ç–∞–±–µ–ª—è

## –ü—Ä–æ–±–ª–µ–º–∞
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å '1' –Ω–µ –≤–∏–¥—è—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ —Å–º–µ—Ç –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏–∑ —Ñ–æ—Ä–º—ã —Ç–∞–±–µ–ª—è.

## –ü—Ä–∏—á–∏–Ω–∞
1. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–≥—Ä—É–∂–∞–ª –≤—Å–µ —Å–º–µ—Ç—ã –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
2. –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–º–µ—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª fallback, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π –í–°–ï —Å–º–µ—Ç—ã
3. –≠—Ç–æ —Å–±–∏–≤–∞–ª–æ —Å —Ç–æ–ª–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. –ù–µ –±—ã–ª–æ —á–µ—Ç–∫–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ —Ç–æ–º, –ø–æ—á–µ–º—É —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π

## –†–µ—à–µ–Ω–∏–µ

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `web-client/src/views/documents/TimesheetFormView.vue`

#### 1. –£–±—Ä–∞–Ω –∑–∞–ø—É—Ç–∞–Ω–Ω—ã–π fallback –º–µ—Ö–∞–Ω–∏–∑–º

**–ë—ã–ª–æ:**
```typescript
const estimatesForPicker = computed(() => {
  const filtered = filteredEstimates.value
  // If filtering results in 0 items, show all estimates as fallback
  if (filtered.length === 0 && formData.value.object_id) {
    return estimatesData.value.map((e) => ({
      id: e.id!,
      name: `${e.number} –æ—Ç ${formatDate(e.date)} (${getObjectName(e.object_id)})`,
    }))
  }
  return filtered
})
```

**–°—Ç–∞–ª–æ:**
```typescript
const estimatesForPicker = computed(() => {
  return filteredEstimates.value
})

const estimatePickerPlaceholder = computed(() => {
  if (!formData.value.object_id) {
    return '–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç'
  }
  if (filteredEstimates.value.length === 0) {
    return '–ù–µ—Ç —Å–º–µ—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞'
  }
  return `–í—ã–±–µ—Ä–∏—Ç–µ —Å–º–µ—Ç—É (–¥–æ—Å—Ç—É–ø–Ω–æ: ${filteredEstimates.value.length})`
})
```

#### 2. –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π placeholder

Picker —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- "–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç" - –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω
- "–ù–µ—Ç —Å–º–µ—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞" - –µ—Å–ª–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ –Ω–µ—Ç —Å–º–µ—Ç
- "–í—ã–±–µ—Ä–∏—Ç–µ —Å–º–µ—Ç—É (–¥–æ—Å—Ç—É–ø–Ω–æ: N)" - –µ—Å–ª–∏ –µ—Å—Ç—å —Å–º–µ—Ç—ã

#### 3. –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

```vue
<p
  v-if="formData.value.object_id && filteredEstimates.length === 0"
  class="mt-1 text-sm text-amber-600"
>
  ‚ö†Ô∏è –î–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ—Ç —Å–º–µ—Ç. –°–æ–∑–¥–∞–π—Ç–µ —Å–º–µ—Ç—É –≤ —Ä–∞–∑–¥–µ–ª–µ "–î–æ–∫—É–º–µ–Ω—Ç—ã ‚Üí –°–º–µ—Ç—ã".
</p>
```

#### 4. Picker –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω

```vue
<Picker
  v-model="formData.estimate_id"
  label="–°–º–µ—Ç–∞"
  :items="estimatesForPicker"
  :disabled="formData.is_posted || !formData.value.object_id"
  :error="errors.estimate_id"
  :placeholder="estimatePickerPlaceholder"
/>
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚ùå –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–º–µ—Ç –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å –í–°–ï —Å–º–µ—Ç—ã
2. ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –≤—ã–±—Ä–∞—Ç—å —Å–º–µ—Ç—É –æ—Ç –¥—Ä—É–≥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
3. ‚ùå –ù–µ –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–æ, –ø–æ—á–µ–º—É —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π –∏–ª–∏ –ø–æ–ª–Ω—ã–π
4. ‚ùå –ó–∞–ø—É—Ç–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ fallback

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–º–µ—Ç—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
2. ‚úÖ –ß–µ—Ç–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–µ—Ç —Å–º–µ—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞"
3. ‚úÖ –ü–æ–¥—Å–∫–∞–∑–∫–∞, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Å–º–µ—Ç—É
4. ‚úÖ –°—á–µ—Ç—á–∏–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–º–µ—Ç –≤ placeholder
5. ‚úÖ Picker –æ—Ç–∫–ª—é—á–µ–Ω –¥–æ –≤—ã–±–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–±—ä–µ–∫—Ç –±–µ–∑ —Å–º–µ—Ç
1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–µ–ª—è
2. –í—ã–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç —Å–º–µ—Ç
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - Picker "–°–º–µ—Ç–∞" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç "–ù–µ—Ç —Å–º–µ—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞"
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å–º–µ—Ç—É

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û–±—ä–µ–∫—Ç —Å–æ —Å–º–µ—Ç–∞–º–∏
1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–µ–ª—è
2. –í—ã–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å —Å–º–µ—Ç—ã
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - Picker "–°–º–µ—Ç–∞" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç "–í—ã–±–µ—Ä–∏—Ç–µ —Å–º–µ—Ç—É (–¥–æ—Å—Ç—É–ø–Ω–æ: N)"
   - –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–º–µ—Ç—ã –¥–ª—è —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
   - –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å–º–µ—Ç—É

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–º–µ–Ω–∞ –æ–±—ä–µ–∫—Ç–∞
1. –í—ã–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç –ê —Å–æ —Å–º–µ—Ç–∞–º–∏
2. –í—ã–±—Ä–∞—Ç—å —Å–º–µ—Ç—É
3. –°–º–µ–Ω–∏—Ç—å –æ–±—ä–µ–∫—Ç –Ω–∞ –ë –±–µ–∑ —Å–º–µ—Ç
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –í—ã–±—Ä–∞–Ω–Ω–∞—è —Å–º–µ—Ç–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–µ—Ç —Å–º–µ—Ç –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞"

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ë–µ–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–µ–ª—è
2. –ù–µ –≤—ã–±–∏—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - Picker "–°–º–µ—Ç–∞" –æ—Ç–∫–ª—é—á–µ–Ω
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è "–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç"

## –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –û–±—ä–µ–∫—Ç—ã —Å–æ —Å–º–µ—Ç–∞–º–∏:
- **–û–±—ä–µ–∫—Ç ID 1:** 4 —Å–º–µ—Ç—ã (TEST-001, TEST-001, TEST-001-UPDATED, TEST-002)
- **–û–±—ä–µ–∫—Ç ID 3:** 2 —Å–º–µ—Ç—ã (TEST-001, TEST-GROUPS)
- **–û–±—ä–µ–∫—Ç ID 4:** 2 —Å–º–µ—Ç—ã (295, 295)

### –û–±—ä–µ–∫—Ç—ã –±–µ–∑ —Å–º–µ—Ç:
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (ID 5-28)

## –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –°–µ—Ä–≤–µ—Ä–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
–î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é:

```typescript
async function handleObjectChange() {
  formData.value.estimate_id = 0
  await loadEstimatesForObject(formData.value.object_id)
}

async function loadEstimatesForObject(objectId: number) {
  if (!objectId) {
    estimatesData.value = []
    return
  }
  
  try {
    const response = await documentsApi.getEstimates({ 
      page: 1, 
      page_size: 1000,
      object_id: objectId  // –°–µ—Ä–≤–µ—Ä–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
    })
    estimatesData.value = response.data.filter((e) => !e.marked_for_deletion)
  } catch (error) {
    console.error('Failed to load estimates:', error)
    estimatesData.value = []
  }
}
```

### 2. –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–º–µ—Ç—ã
–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–°–æ–∑–¥–∞—Ç—å —Å–º–µ—Ç—É" —Ä—è–¥–æ–º —Å picker'–æ–º, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Å–º–µ—Ç—ã —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º.

### 3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–º–µ—Ç—ã –ø–æ –æ–±—ä–µ–∫—Ç–∞–º, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏.

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- ‚úÖ `web-client/src/views/documents/TimesheetFormView.vue`

## –§–∞–π–ª—ã –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
- üìÑ `TIMESHEET_ESTIMATE_FILTER_ANALYSIS.md` - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
- üìÑ `api/endpoints/documents.py` - –ë—ç–∫–µ–Ω–¥ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é)
- üìÑ `web-client/src/components/common/Picker.vue` - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Picker
