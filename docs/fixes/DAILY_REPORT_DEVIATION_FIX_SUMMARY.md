# Исправление отображения отклонений в ежедневных отчетах

## Проблема
Отклонения в табличной части ежедневных отчетов показывались как 0, даже когда были фактические трудозатраты.

## Причины
1. Поле `planned_labor` могло содержать нечисловые значения
2. В веб-клиенте не было автоматического пересчета отклонений при изменении данных
3. API возвращал поле `deviation_percent`, а фронтенд ожидал `deviation`
4. При загрузке данных отклонения не пересчитывались

## Решение

### 1. Преобразование к числу
Добавлено явное преобразование `planned_labor`, `actual_labor` к `float` с обработкой ошибок во всех местах:
- Desktop приложение (PyQt6)
- Web-клиент (Vue.js)
- API (FastAPI с Pydantic валидатором)

### 2. Автоматический пересчет в веб-клиенте
- При изменении `actual_labor` отклонение пересчитывается автоматически
- При загрузке данных из API отклонения пересчитываются заново
- При автозаполнении из сметы устанавливается отклонение -100%

### 3. Маппинг полей в API
Добавлен маппинг `deviation_percent` → `deviation` для совместимости с фронтендом

## Измененные файлы
1. `src/views/daily_report_document_form.py` - форма desktop приложения
2. `src/services/daily_report_service.py` - сервис загрузки/сохранения
3. `web-client/src/components/documents/DailyReportLines.vue` - табличная часть
4. `web-client/src/views/documents/DailyReportFormView.vue` - форма отчета
5. `api/models/documents.py` - Pydantic модели с валидатором
6. `api/endpoints/documents.py` - API endpoint с маппингом полей

## Формула расчета
```
если planned_labor > 0:
    deviation = ((actual_labor - planned_labor) / planned_labor) * 100
иначе:
    deviation = 0
```

## Результат
✅ Отклонения корректно рассчитываются и отображаются в процентах
✅ Работает в desktop и web версиях
✅ Автоматический пересчет при изменении данных
✅ Корректная загрузка существующих отчетов
✅ Сборка веб-клиента проходит без ошибок
✅ TypeScript ошибки исправлены
