import{printTimesheet as h,printDailyReport as k,printEstimate as _}from"./documents-D6jJUN3y.js";import{f as m,d as $,c as C,w as y,a as s,j as v,k as w,q as x,z as g,t as b,o as f}from"./index-6EFolkGo.js";import{_ as E}from"./Modal.vue_vue_type_script_setup_true_lang-DDauu2p3.js";function z(){const l=m(!1),r=m("");async function p(d,o,a,t){l.value=!0,r.value="";try{const e=await _(d,o);u(e,o,a,t)}catch(e){const n=e;throw r.value=n.response?.data?.detail||"Ошибка при печати",e}finally{l.value=!1}}async function i(d,o,a,t){l.value=!0,r.value="";try{const e=await k(d,o);u(e,o,a,t)}catch(e){const n=e;throw r.value=n.response?.data?.detail||"Ошибка при печати",e}finally{l.value=!1}}function u(d,o,a,t){const e=window.URL.createObjectURL(d);if(a==="open"&&o==="pdf")window.open(e,"_blank");else{const n=document.createElement("a");n.href=e,n.download=`${t}.${o==="pdf"?"pdf":"xlsx"}`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}setTimeout(()=>window.URL.revokeObjectURL(e),100)}async function c(d,o,a,t){l.value=!0,r.value="";try{const e=await h(d,o);u(e,o,a,t)}catch(e){const n=e;throw r.value=n.response?.data?.detail||"Ошибка при печати",e}finally{l.value=!1}}return{loading:l,error:r,printEstimate:p,printDailyReport:i,printTimesheet:c}}const D={class:"space-y-4"},R={class:"space-y-2"},j={class:"flex items-center"},B={class:"flex items-center"},U={key:0,class:"rounded-md bg-red-50 p-4"},T={class:"text-sm text-red-800"},L=["disabled"],V=["disabled"],F=$({__name:"PrintDialog",props:{open:{type:Boolean},documentType:{},documentId:{},documentName:{}},emits:["close","print"],setup(l,{emit:r}){const p=r,i=m("pdf"),u=m(!1),c=m("");function d(){p("print",i.value,"download")}function o(){p("print",i.value,"open")}return(a,t)=>(f(),C(E,{open:l.open,title:"Печать документа",size:"sm",onClose:t[3]||(t[3]=e=>a.$emit("close"))},{footer:y(()=>[s("button",{onClick:t[2]||(t[2]=e=>a.$emit("close")),type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Отмена "),s("button",{onClick:d,type:"button",disabled:u.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},b(u.value?"Загрузка...":"Скачать"),9,L),i.value==="pdf"?(f(),v("button",{key:0,onClick:o,type:"button",disabled:u.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},b(u.value?"Загрузка...":"Открыть"),9,V)):w("",!0)]),default:y(()=>[s("div",D,[s("div",null,[t[6]||(t[6]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Формат печати",-1)),s("div",R,[s("label",j,[x(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),type:"radio",value:"pdf",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[g,i.value]]),t[4]||(t[4]=s("span",{class:"ml-3 text-sm text-gray-700"},"PDF (АРСД)",-1))]),s("label",B,[x(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),type:"radio",value:"excel",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[g,i.value]]),t[5]||(t[5]=s("span",{class:"ml-3 text-sm text-gray-700"},"Excel",-1))])])]),c.value?(f(),v("div",U,[s("p",T,b(c.value),1)])):w("",!0)])]),_:1},8,["open"]))}});export{F as _,z as u};
