import{f as y,g as j,d as O,j as n,a as e,k as m,y as k,q as V,v as L,F as p,p as b,e as h,t as u,o as i,n as S}from"./index-C7yHV0zj.js";function ye(t=50){const r=y({page:1,pageSize:t,search:"",sortBy:"",sortOrder:"asc"}),w=y(!1),x=y([]),f=y();function v(d){r.value.page=d}function g(d){r.value.search=d,r.value.page=1}function $(d,l){r.value.sortBy=d,r.value.sortOrder=l}function C(){r.value={page:1,pageSize:t,search:"",sortBy:"",sortOrder:"asc"}}const B=j(()=>{const d={page:r.value.page,page_size:r.value.pageSize};return r.value.search&&(d.search=r.value.search),r.value.sortBy&&(d.sort_by=r.value.sortBy,d.sort_order=r.value.sortOrder),d});return{state:r,loading:w,data:x,pagination:f,queryParams:B,setPage:v,setSearch:g,setSort:$,reset:C}}const P={class:"space-y-4"},T={class:"flex flex-col sm:flex-row gap-4 justify-between"},D={class:"flex-1 max-w-md"},N={key:0,class:"text-center py-8"},q={key:1,class:"hidden md:block overflow-x-auto"},F={class:"min-w-full divide-y divide-gray-200"},E={class:"bg-gray-50"},I=["onClick"],Q={class:"flex items-center space-x-1"},U={key:0,class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},A={class:"bg-white divide-y divide-gray-200"},G=["onClick"],H={key:0,class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},J={key:2,class:"md:hidden space-y-4"},K=["onClick"],R={class:"space-y-2"},W={class:"text-xs font-medium text-gray-500"},X={class:"text-sm text-gray-900"},Y={key:0,class:"mt-4 pt-4 border-t border-gray-200"},Z={key:3,class:"text-center py-8"},_={key:4,class:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6"},ee={class:"flex flex-1 justify-between sm:hidden"},te=["disabled"],ae=["disabled"],se={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},ne={class:"text-sm text-gray-700"},ie={class:"font-medium"},le={class:"font-medium"},oe={class:"font-medium"},re={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},de=["disabled"],ce=["onClick"],ue=["disabled"],ve=O({__name:"DataTable",props:{columns:{},data:{},loading:{type:Boolean},pagination:{}},emits:["row-click","page-change","search","sort"],setup(t,{emit:r}){const w=t,x=r,f=y(""),v=y(""),g=y("asc"),$=j(()=>{if(!w.pagination)return[];const{page:l,total_pages:a}=w.pagination,s=[],c=5;let o=Math.max(1,l-Math.floor(c/2));const z=Math.min(a,o+c-1);z-o<c-1&&(o=Math.max(1,z-c+1));for(let M=o;M<=z;M++)s.push(M);return s});function C(){x("search",f.value)}function B(l){v.value===l?g.value=g.value==="asc"?"desc":"asc":(v.value=l,g.value="asc"),x("sort",v.value,g.value)}function d(l){x("page-change",l)}return(l,a)=>(i(),n("div",P,[e("div",T,[e("div",D,[V(e("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>f.value=s),type:"text",placeholder:"Поиск...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",onInput:C},null,544),[[L,f.value]])]),k(l.$slots,"header-actions")]),t.loading?(i(),n("div",N,[...a[5]||(a[5]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-2 text-sm text-gray-600"},"Загрузка...",-1)])])):t.data.length>0?(i(),n("div",q,[e("table",F,[e("thead",E,[e("tr",null,[(i(!0),n(p,null,b(t.columns,s=>(i(),n("th",{key:s.key,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:c=>B(s.key)},[e("div",Q,[e("span",null,u(s.label),1),v.value===s.key?(i(),n("svg",{key:0,class:S(["w-4 h-4",g.value==="asc"?"":"transform rotate-180"]),fill:"currentColor",viewBox:"0 0 20 20"},[...a[6]||(a[6]=[e("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"},null,-1)])],2)):m("",!0)])],8,I))),128)),l.$slots.actions?(i(),n("th",U," Действия ")):m("",!0)])]),e("tbody",A,[(i(!0),n(p,null,b(t.data,(s,c)=>(i(),n("tr",{key:c,class:"hover:bg-gray-50 cursor-pointer",onClick:o=>l.$emit("row-click",s)},[(i(!0),n(p,null,b(t.columns,o=>(i(),n("td",{key:o.key,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},[k(l.$slots,`cell-${o.key}`,{row:s,value:s[o.key]},()=>[h(u(s[o.key]),1)])]))),128)),l.$slots.actions?(i(),n("td",H,[k(l.$slots,"actions",{row:s})])):m("",!0)],8,G))),128))])])])):(i(),n("div",J,[(i(!0),n(p,null,b(t.data,(s,c)=>(i(),n("div",{key:c,class:"bg-white shadow rounded-lg p-4 cursor-pointer hover:shadow-md",onClick:o=>l.$emit("row-click",s)},[e("div",R,[(i(!0),n(p,null,b(t.columns,o=>(i(),n("div",{key:o.key},[e("div",W,u(o.label),1),e("div",X,[k(l.$slots,`cell-${o.key}`,{row:s,value:s[o.key]},()=>[h(u(s[o.key]),1)])])]))),128))]),l.$slots.actions?(i(),n("div",Y,[k(l.$slots,"actions",{row:s})])):m("",!0)],8,K))),128))])),!t.loading&&t.data.length===0?(i(),n("div",Z,[...a[7]||(a[7]=[e("p",{class:"text-gray-500"},"Нет данных",-1)])])):m("",!0),t.pagination&&t.pagination.total_pages>1?(i(),n("div",_,[e("div",ee,[e("button",{onClick:a[1]||(a[1]=s=>d(t.pagination.page-1)),disabled:t.pagination.page===1,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Назад ",8,te),e("button",{onClick:a[2]||(a[2]=s=>d(t.pagination.page+1)),disabled:t.pagination.page===t.pagination.total_pages,class:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Вперед ",8,ae)]),e("div",se,[e("div",null,[e("p",ne,[a[8]||(a[8]=h(" Показано ",-1)),e("span",ie,u((t.pagination.page-1)*t.pagination.page_size+1),1),a[9]||(a[9]=h(" - ",-1)),e("span",le,u(Math.min(t.pagination.page*t.pagination.page_size,t.pagination.total_items)),1),a[10]||(a[10]=h(" из ",-1)),e("span",oe,u(t.pagination.total_items),1),a[11]||(a[11]=h(" записей ",-1))])]),e("div",null,[e("nav",re,[e("button",{onClick:a[3]||(a[3]=s=>d(t.pagination.page-1)),disabled:t.pagination.page===1,class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...a[12]||(a[12]=[e("span",{class:"sr-only"},"Назад",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)])],8,de),(i(!0),n(p,null,b($.value,s=>(i(),n("button",{key:s,onClick:c=>d(s),class:S([s===t.pagination.page?"z-10 bg-blue-600 text-white":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 text-sm font-semibold"])},u(s),11,ce))),128)),e("button",{onClick:a[4]||(a[4]=s=>d(t.pagination.page+1)),disabled:t.pagination.page===t.pagination.total_pages,class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...a[13]||(a[13]=[e("span",{class:"sr-only"},"Вперед",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z","clip-rule":"evenodd"})],-1)])],8,ue)])])])])):m("",!0)]))}});export{ve as _,ye as u};
