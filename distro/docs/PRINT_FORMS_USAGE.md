# Инструкция по использованию печатных форм

## Быстрый старт

### Печать сметы

1. Откройте смету в форме документа
2. Нажмите кнопку **"Печать (Ctrl+P)"** или используйте горячую клавишу `Ctrl+P`
3. PDF файл автоматически откроется в программе просмотра по умолчанию

### Печать ежедневного отчета

1. Откройте ежедневный отчет в форме документа
2. Нажмите кнопку **"Печать (Ctrl+P)"** или используйте горячую клавишу `Ctrl+P`
3. PDF файл автоматически откроется в программе просмотра по умолчанию

## Формат печатных форм

### Смета (Локальный сметный расчет)

Печатная форма сметы соответствует формату АРСД и включает:

**Шапка документа:**
- Согласовано (Заказчик) / Утверждаю (Подрядчик)
- Номер и дата сметы
- Наименование объекта

**Таблица работ:**
- Номер строки
- Код работы
- Наименование работы
- Единица измерения
- Количество
- **На единицу работ:** зарплата, материалы/механизмы, всего, трудозатраты
- **На полный объём:** зарплата, материалы/механизмы, всего, трудозатраты

**Итоги:**
- Общая сумма
- Общие трудозатраты

### Ежедневный отчет

Печатная форма ежедневного отчета включает:

**Шапка документа:**
- Дата отчета
- Номер и дата сметы
- Наименование объекта
- ФИО бригадира

**Таблица выполненных работ:**
- Номер строки
- Наименование работы
- Единица измерения
- Объем работ
- Плановые трудозатраты
- Фактические трудозатраты
- Отклонение в процентах
- Список исполнителей

**Итоги:**
- Итого плановые трудозатраты
- Итого фактические трудозатраты
- Общее отклонение

**Подписи:**
- Бригадир (с местом для подписи)
- Принял (с местом для подписи)

## Технические детали

### Требования

- Python 3.8+
- ReportLab 3.6.0+
- PyQt6

### Расположение файлов

- **Генераторы печатных форм:** `src/services/`
  - `estimate_print_form.py` - генератор сметы
  - `daily_report_print_form.py` - генератор ежедневного отчета
  - `print_form_generator.py` - базовый класс

- **Интеграция в формы:** `src/views/`
  - `estimate_document_form.py` - форма сметы
  - `daily_report_document_form.py` - форма ежедневного отчета

### Временные файлы

PDF файлы создаются во временной директории системы и автоматически открываются в программе просмотра по умолчанию. Файлы не удаляются автоматически, чтобы пользователь мог их сохранить.

### Поддержка кириллицы

Печатные формы используют шрифт DejaVu Sans для корректного отображения русского текста. Если шрифт недоступен, используется Helvetica с ограниченной поддержкой кириллицы.

## Устранение неполадок

### PDF не открывается

**Проблема:** После нажатия кнопки "Печать" ничего не происходит.

**Решение:**
1. Убедитесь, что установлена программа для просмотра PDF (Adobe Reader, Foxit Reader и т.д.)
2. Проверьте, что PDF ассоциирован с программой просмотра в настройках Windows
3. Проверьте временную директорию на наличие созданных PDF файлов

### Ошибка генерации

**Проблема:** Появляется сообщение "Не удалось сгенерировать печатную форму".

**Решение:**
1. Убедитесь, что документ сохранен (имеет ID)
2. Проверьте, что все обязательные поля заполнены
3. Проверьте логи приложения на наличие ошибок

### Неправильное отображение текста

**Проблема:** Русский текст отображается некорректно или заменяется на символы.

**Решение:**
1. Установите шрифт DejaVu Sans в систему
2. Перезапустите приложение

## Дополнительная информация

Подробная техническая документация доступна в файле `PRINT_FORMS_ARSD.md`.
