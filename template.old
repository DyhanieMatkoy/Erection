# Требования к системе управления рабочим временем строительных бригад

## Введение

QT6 mvp для моделирования Веб-приложения для управления рабочим временем строительных бригад

## Глоссарь

- **УчетнаяСистема**: Приложение для управления материально-техническими ценностями
- **ТМЦ**: Материально-технические ценности (оборудование, инструменты, материалы)
- **Мобильное_Приложение**: Android-приложение для работы с системой

## Требования

### Требование 1

**Пользовательская история:** Как сотрудник, я хочу загружать из эксель и просматривать список строительных смет (см.образец пример сметы арсд.xlsx)

#### Критерии приемки

1. КОГДА пользователь открывает форму списка смет, он может нажать Enter для просмотра существующей или F9 для открытия формы новой сметы
2. В форме новой сметы заполняются реквизиты  
Номер, 
Дата,  
Заказчик (тип:справочник Контрагенты, представление в виде наименования, строка 150 символов), 
Объект (тип:справочник Объекты, подчинен спр.Контрагенты),
Подрядчик (тип:справочник Организации, по умолчанию заполнен значением из константы ОсновнаяОрганизация)
Ответственный (тип:справочник Физлица, по умолчанию заполнен значением поля ОсновнойОтветственный константы ОсновнаяОрганизация)
3. В табличной части в графе "Наименование работ и затрат" заполняются работы из справочника Работы.
Справочник Работы содержит цену и норму трудозатрат, которые подставляются при подборе в табличную часть сметы, помноженные на значение реквизита количество таб.части.
4. Выходная печатная форма сметы

### Требование 2

**Пользовательская история:** Как бригадир, я хочу редактировать ежедневный отчет фактического исполнения плановых трудозатрат сметы (см.образец Форма ежедневного отчета.jpg)

#### Критерии приемки

1. КОГДА бригадир открывает форму ежедневного отчета, УчетнаяСистема ДОЛЖНА отобразить список смет с незавершенными работами
2. КОГДА бригадир выбирает смету, УчетнаяСистема ДОЛЖНА отобразить табличную часть с полями: Дата, Работа (из сметы), Плановые трудозатраты (из сметы), Фактические трудозатраты (редактируемое поле), Исполнители (множественный выбор из справочника Физлица)
3. КОГДА бригадир вводит фактические трудозатраты, УчетнаяСистема ДОЛЖНА автоматически рассчитать отклонение от плана в процентах
4. КОГДА бригадир сохраняет отчет, УчетнаяСистема ДОЛЖНА проверить, что сумма фактических трудозатрат по всем исполнителям соответствует указанному значению
5. УчетнаяСистема ДОЛЖНА формировать печатную форму ежедневного отчета за время не более 5 секунд

### Требование 3

**Пользовательская история:** Как руководитель проекта, я хочу просматривать аналитические отчеты по выполнению смет, чтобы контролировать ход работ и бюджет

#### Критерии приемки

1. КОГДА руководитель открывает форму аналитики, УчетнаяСистема ДОЛЖНА предоставить выбор периода анализа (день, неделя, месяц, произвольный период)
2. КОГДА выбран период, УчетнаяСистема ДОЛЖНА отобразить сводную таблицу с колонками: Смета, Объект, Плановые трудозатраты, Фактические трудозатраты, Отклонение (%), Плановая стоимость, Фактическая стоимость, Отклонение по стоимости
3. КОГДА запрашивается детализация по смете, УчетнаяСистема ДОЛЖНА показать разбивку по видам работ с указанием исполнителей
4. КОГДА руководитель запрашивает экспорт отчета, УчетнаяСистема ДОЛЖНА предоставить выбор формата (PDF, Excel, CSV)
5. УчетнаяСистема ДОЛЖНА формировать аналитические отчеты за время не более 10 секунд

### Требование 4

**Пользовательская история:** Как администратор системы, я хочу управлять справочниками (Контрагенты, Объекты, Организации, Физлица, Работы), чтобы поддерживать актуальность данных

#### Критерии приемки

1. КОГДА администратор открывает справочник Контрагенты, УчетнаяСистема ДОЛЖНА отобразить список с возможностью добавления, редактирования и пометки на удаление записей
2. КОГДА администратор создает новый элемент справочника Контрагенты, УчетнаяСистема ДОЛЖНА запросить обязательные поля: Наименование (строка 150 символов), ИНН (строка 12 символов), Контактное лицо (строка 100 символов), Телефон (строка 20 символов)
3. КОГДА администратор открывает справочник Объекты, УчетнаяСистема ДОЛЖНА отобразить иерархический список, подчиненный справочнику Контрагенты
4. КОГДА администратор создает новый элемент справочника Работы, УчетнаяСистема ДОЛЖНА запросить поля: Наименование (строка 200 символов), Единица измерения (справочник ЕдиницыИзмерения), Цена (число 15.2), Норма трудозатрат в часах (число 10.2)
5. КОГДА администратор пытается удалить элемент справочника, используемый в документах, УчетнаяСистема ДОЛЖНА запретить удаление и показать сообщение с указанием документов, где используется элемент

### Требование 5

**Пользовательская история:** Как пользователь системы, я хочу иметь разграничение прав доступа, чтобы каждый сотрудник работал только со своими данными

#### Критерии приемки

1. КОГДА пользователь входит в систему, УчетнаяСистема ДОЛЖНА проверить его учетные данные и назначить роль (Администратор, Руководитель, Бригадир, Сотрудник)
2. КОГДА пользователь с ролью Бригадир открывает список смет, УчетнаяСистема ДОЛЖНА показать только сметы, где он указан как Ответственный
3. КОГДА пользователь с ролью Сотрудник открывает ежедневные отчеты, УчетнаяСистема ДОЛЖНА показать только отчеты, где он указан как Исполнитель
4. КОГДА пользователь с ролью Руководитель запрашивает аналитику, УчетнаяСистема ДОЛЖНА предоставить доступ ко всем сметам и отчетам организации
5. КОГДА пользователь пытается выполнить действие, не разрешенное его ролью, УчетнаяСистема ДОЛЖНА отклонить операцию и показать сообщение "Недостаточно прав для выполнения операции"

### Требование 6

**Пользовательская история:** Как пользователь мобильного приложения, я хочу вносить данные о выполненных работах с мобильного устройства на объекте

#### Критерии приемки

1. КОГДА пользователь открывает Мобильное_Приложение, УчетнаяСистема ДОЛЖНА синхронизировать актуальный список смет и работ за время не более 30 секунд
2. КОГДА пользователь в Мобильное_Приложение выбирает смету, УчетнаяСистема ДОЛЖНА отобразить список работ с возможностью ввода фактических трудозатрат
3. КОГДА пользователь вводит данные в Мобильное_Приложение в режиме офлайн, УчетнаяСистема ДОЛЖНА сохранить данные локально и синхронизировать их при появлении интернет-соединения
4. КОГДА происходит синхронизация данных, УчетнаяСистема ДОЛЖНА проверить наличие конфликтов и в случае обнаружения показать пользователю диалог разрешения конфликта
5. КОГДА пользователь завершает ввод данных за день, Мобильное_Приложение ДОЛЖНА отправить уведомление бригадиру о готовности отчета

### Требование 7

**Пользовательская история:** Как бухгалтер, я хочу формировать акты выполненных работ на основе ежедневных отчетов для расчетов с заказчиками

#### Критерии приемки

1. КОГДА бухгалтер открывает форму создания акта, УчетнаяСистема ДОЛЖНА предложить выбрать смету и период выполнения работ
2. КОГДА выбраны смета и период, УчетнаяСистема ДОЛЖНА автоматически заполнить табличную часть акта данными из ежедневных отчетов с группировкой по видам работ
3. КОГДА бухгалтер формирует акт, УчетнаяСистема ДОЛЖНА рассчитать итоговую стоимость на основе фактически выполненных объемов и цен из сметы
4. КОГДА акт сохраняется, УчетнаяСистема ДОЛЖНА присвоить ему уникальный номер в формате "АКТ-ГГГГММДД-NNNN"
5. УчетнаяСистема ДОЛЖНА формировать печатную форму акта выполненных работ в соответствии с унифицированной формой КС-2

### Требование 8

**Пользовательская история:** Как пользователь системы, я хочу работать с формами списков и документов в стиле 1С 8.3 с привычными горячими клавишами и автоматическими пересчетами

#### Критерии приемки

1. КОГДА пользователь работает с формой списка, УчетнаяСистема ДОЛЖНА поддерживать следующие горячие клавиши: Insert или F9 (создание нового элемента), Enter (открытие выбранного элемента), Delete (пометка на удаление), Ctrl+F (быстрый поиск), Ctrl+D (копирование элемента)
2. КОГДА пользователь работает с формой документа или элемента справочника, УчетнаяСистема ДОЛЖНА поддерживать горячие клавиши: Ctrl+S (записать), Ctrl+Shift+S (записать и закрыть), Esc (закрыть без сохранения с подтверждением при наличии изменений), Ctrl+P (печать)
3. КОГДА пользователь работает с табличной частью документа, УчетнаяСистема ДОЛЖНА поддерживать горячие клавиши: Insert (добавить строку), Delete (удалить строку), F4 (открыть форму выбора для поля справочника), Ctrl+C/Ctrl+V (копировать/вставить строки), Ctrl+Plus/Ctrl+Minus (добавить/удалить строку)
4. КОГДА пользователь изменяет значение поля Количество в табличной части сметы, УчетнаяСистема ДОЛЖНА автоматически пересчитать поле Сумма как произведение Количество × Цена за время не более 100 миллисекунд
5. КОГДА пользователь изменяет значение поля Цена в табличной части сметы, УчетнаяСистема ДОЛЖНА автоматически пересчитать поле Сумма как произведение Количество × Цена за время не более 100 миллисекунд
6. КОГДА пользователь изменяет значение поля Норма_трудозатрат в табличной части сметы, УчетнаяСистема ДОЛЖНА автоматически пересчитать поле Плановые_трудозатраты как произведение Количество × Норма_трудозатрат за время не более 100 миллисекунд
7. КОГДА происходит изменение любой строки табличной части документа, УчетнаяСистема ДОЛЖНА автоматически пересчитать итоговые суммы документа (Итого_сумма, Итого_трудозатраты) за время не более 200 миллисекунд
8. КОГДА пользователь добавляет или удаляет строку в табличной части, УчетнаяСистема ДОЛЖНА автоматически пересчитать итоговые суммы документа за время не более 200 миллисекунд
9. КОГДА пользователь нажимает F4 в поле справочника, УчетнаяСистема ДОЛЖНА открыть форму выбора элемента справочника с возможностью быстрого поиска по наименованию
10. КОГДА пользователь начинает вводить текст в поле справочника, УчетнаяСистема ДОЛЖНА предоставить автодополнение с выпадающим списком подходящих элементов справочника (минимум 3 символа для активации)
11. КОГДА пользователь нажимает Ctrl+Enter в многострочном текстовом поле, УчетнаяСистема ДОЛЖНА добавить перенос строки
12. КОГДА пользователь работает с формой списка, УчетнаяСистема ДОЛЖНА сохранять настройки отображения колонок (ширина, порядок, видимость) для каждого пользователя
13. КОГДА пользователь дважды щелкает на разделителе колонок в форме списка, УчетнаяСистема ДОЛЖНА автоматически подобрать ширину колонки по содержимому
14. КОГДА пользователь нажимает Ctrl+F в форме списка, УчетнаяСистема ДОЛЖНА активировать строку быстрого поиска с фильтрацией списка по мере ввода текста
15. КОГДА пользователь закрывает форму документа с несохраненными изменениями, УчетнаяСистема ДОЛЖНА показать диалог подтверждения с вариантами: "Сохранить", "Не сохранять", "Отмена"
