import{f as h,g as V,d as N,m as R,j as l,a as e,k as v,q,v as A,y as x,F as f,p as k,e as w,t as y,o as i,n as O,i as F}from"./index-BmuF08LN.js";function Se(t=50){const d=h({page:1,pageSize:t,search:"",sortBy:"",sortOrder:"asc"}),B=h(!1),g=h([]),b=h();function C(c){d.value.page=c}function m(c){d.value.search=c,d.value.page=1}function p(c,z){d.value.sortBy=c,d.value.sortOrder=z}function r(){d.value={page:1,pageSize:t,search:"",sortBy:"",sortOrder:"asc"}}const S=V(()=>{const c={page:d.value.page,page_size:d.value.pageSize};return d.value.search&&(c.search=d.value.search),d.value.sortBy&&(c.sort_by=d.value.sortBy,c.sort_order=d.value.sortOrder),c});return{state:d,loading:B,data:g,pagination:b,queryParams:S,setPage:C,setSearch:m,setSort:p,reset:r}}const I={class:"space-y-4"},E={class:"flex flex-col sm:flex-row gap-4 justify-between"},Q={class:"flex-1 max-w-md"},U={class:"flex gap-2"},G={key:0,class:"text-center py-8"},H={key:1},J={class:"hidden md:block overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200"},W={class:"bg-gray-50"},X={key:0,class:"px-6 py-3 text-left"},Y=["checked"],Z=["onClick"],_={class:"flex items-center space-x-1"},ee={key:1,class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},te={class:"bg-white divide-y divide-gray-200"},ae=["onClick"],se=["checked","onChange"],ne={key:1,class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},le={class:"md:hidden space-y-4"},ie=["onClick"],oe={class:"space-y-2"},de={class:"text-xs font-medium text-gray-500"},re={class:"text-sm text-gray-900"},ce={key:0,class:"mt-4 pt-4 border-t border-gray-200"},ue={key:2,class:"text-center py-8"},ge={key:3,class:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6"},ve={class:"flex flex-1 justify-between sm:hidden"},ye=["disabled"],he=["disabled"],be={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},pe={class:"text-sm text-gray-700"},me={class:"font-medium"},xe={class:"font-medium"},fe={class:"font-medium"},ke={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},we=["disabled"],Ce=["onClick"],$e=["disabled"],ze=N({__name:"DataTable",props:{columns:{},data:{},loading:{type:Boolean},pagination:{},selectable:{type:Boolean}},emits:["row-click","page-change","search","sort","selection-change"],setup(t,{expose:d,emit:B}){const g=t,b=B,C=h(""),m=h(""),p=h("asc"),r=h([]),S=V(()=>{if(!g.pagination)return[];const{page:n,total_pages:a}=g.pagination,s=[],u=5;let o=Math.max(1,n-Math.floor(u/2));const M=Math.min(a,o+u-1);M-o<u-1&&(o=Math.max(1,M-u+1));for(let j=o;j<=M;j++)s.push(j);return s});function c(){b("search",C.value)}function z(n){m.value===n?p.value=p.value==="asc"?"desc":"asc":(m.value=n,p.value="asc"),b("sort",m.value,p.value)}function $(n){b("page-change",n)}const L=V(()=>g.data&&g.data.length>0&&r.value.length===g.data.length);function P(n){return r.value.some(a=>a.id===n.id)}function T(n){const a=r.value.findIndex(s=>s.id===n.id);a>-1?r.value.splice(a,1):r.value.push(n),b("selection-change",r.value)}function D(){L.value?r.value=[]:r.value=[...g.data],b("selection-change",r.value)}return R(()=>g.data,()=>{r.value=[]}),d({clearSelection:()=>{r.value=[]}}),(n,a)=>(i(),l("div",I,[e("div",E,[e("div",Q,[q(e("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>C.value=s),type:"text",placeholder:"Поиск...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",onInput:c},null,544),[[A,C.value]])]),e("div",U,[x(n.$slots,"bulk-actions",{selected:r.value}),x(n.$slots,"header-actions")])]),t.loading?(i(),l("div",G,[...a[6]||(a[6]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-2 text-sm text-gray-600"},"Загрузка...",-1)])])):t.data&&t.data.length>0?(i(),l("div",H,[e("div",J,[e("table",K,[e("thead",W,[e("tr",null,[t.selectable?(i(),l("th",X,[e("input",{type:"checkbox",checked:L.value,onChange:D,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,40,Y)])):v("",!0),(i(!0),l(f,null,k(t.columns,s=>(i(),l("th",{key:s.key,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:u=>z(s.key)},[e("div",_,[e("span",null,y(s.label),1),m.value===s.key?(i(),l("svg",{key:0,class:O(["w-4 h-4",p.value==="asc"?"":"transform rotate-180"]),fill:"currentColor",viewBox:"0 0 20 20"},[...a[7]||(a[7]=[e("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"},null,-1)])],2)):v("",!0)])],8,Z))),128)),n.$slots.actions?(i(),l("th",ee," Действия ")):v("",!0)])]),e("tbody",te,[(i(!0),l(f,null,k(t.data,(s,u)=>(i(),l("tr",{key:u,class:O(["hover:bg-gray-50",t.selectable?"":"cursor-pointer",P(s)?"bg-blue-50":""]),onClick:o=>t.selectable?null:n.$emit("row-click",s)},[t.selectable?(i(),l("td",{key:0,class:"px-6 py-4 whitespace-nowrap",onClick:a[1]||(a[1]=F(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:P(s),onChange:o=>T(s),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,40,se)])):v("",!0),(i(!0),l(f,null,k(t.columns,o=>(i(),l("td",{key:o.key,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},[x(n.$slots,`cell-${o.key}`,{row:s,value:s[o.key]},()=>[w(y(s[o.key]),1)])]))),128)),n.$slots.actions?(i(),l("td",ne,[x(n.$slots,"actions",{row:s})])):v("",!0)],10,ae))),128))])])]),e("div",le,[(i(!0),l(f,null,k(t.data,(s,u)=>(i(),l("div",{key:u,class:"bg-white shadow rounded-lg p-4 cursor-pointer hover:shadow-md",onClick:o=>n.$emit("row-click",s)},[e("div",oe,[(i(!0),l(f,null,k(t.columns,o=>(i(),l("div",{key:o.key},[e("div",de,y(o.label),1),e("div",re,[x(n.$slots,`cell-${o.key}`,{row:s,value:s[o.key]},()=>[w(y(s[o.key]),1)])])]))),128))]),n.$slots.actions?(i(),l("div",ce,[x(n.$slots,"actions",{row:s})])):v("",!0)],8,ie))),128))])])):v("",!0),!t.loading&&(!t.data||t.data.length===0)?(i(),l("div",ue,[...a[8]||(a[8]=[e("p",{class:"text-gray-500"},"Нет данных",-1)])])):v("",!0),t.pagination&&t.pagination.total_pages>1?(i(),l("div",ge,[e("div",ve,[e("button",{onClick:a[2]||(a[2]=s=>$(t.pagination.page-1)),disabled:t.pagination.page===1,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Назад ",8,ye),e("button",{onClick:a[3]||(a[3]=s=>$(t.pagination.page+1)),disabled:t.pagination.page===t.pagination.total_pages,class:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Вперед ",8,he)]),e("div",be,[e("div",null,[e("p",pe,[a[9]||(a[9]=w(" Показано ",-1)),e("span",me,y((t.pagination.page-1)*t.pagination.page_size+1),1),a[10]||(a[10]=w(" - ",-1)),e("span",xe,y(Math.min(t.pagination.page*t.pagination.page_size,t.pagination.total_items)),1),a[11]||(a[11]=w(" из ",-1)),e("span",fe,y(t.pagination.total_items),1),a[12]||(a[12]=w(" записей ",-1))])]),e("div",null,[e("nav",ke,[e("button",{onClick:a[4]||(a[4]=s=>$(t.pagination.page-1)),disabled:t.pagination.page===1,class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...a[13]||(a[13]=[e("span",{class:"sr-only"},"Назад",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)])],8,we),(i(!0),l(f,null,k(S.value,s=>(i(),l("button",{key:s,onClick:u=>$(s),class:O([s===t.pagination.page?"z-10 bg-blue-600 text-white":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 text-sm font-semibold"])},y(s),11,Ce))),128)),e("button",{onClick:a[5]||(a[5]=s=>$(t.pagination.page+1)),disabled:t.pagination.page===t.pagination.total_pages,class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[...a[14]||(a[14]=[e("span",{class:"sr-only"},"Вперед",-1),e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z","clip-rule":"evenodd"})],-1)])],8,$e)])])])])):v("",!0)]))}});export{ze as _,Se as u};
