import{f,g as D,d as Q,p as X,h as G,A as J,j as n,a as e,k as u,l as W,s as Y,B as x,n as C,e as w,t as g,F as $,m as B,o as i,q as Z,i as I}from"./index-OcrUBGsV.js";function rt(s=50){const c=f({page:1,pageSize:s,search:"",sortBy:"",sortOrder:"asc"}),j=f(!1),v=f([]),b=f();function M(r){c.value.page=r}function z(r){c.value.search=r,c.value.page=1}function m(r,k){c.value.sortBy=r,c.value.sortOrder=k}function h(){c.value={page:1,pageSize:s,search:"",sortBy:"",sortOrder:"asc"}}const d=D(()=>{const r={page:c.value.page,page_size:c.value.pageSize};return c.value.search&&(r.search=c.value.search),c.value.sortBy&&(r.sort_by=c.value.sortBy,r.sort_order=c.value.sortOrder),r});return{state:c,loading:j,data:v,pagination:b,queryParams:d,setPage:M,setSearch:z,setSort:m,reset:h}}const _={class:"space-y-4"},ee={class:"bg-white border border-gray-200 rounded-lg p-4 space-y-4"},te={class:"flex flex-col sm:flex-row gap-4 justify-between"},se={class:"flex-1 max-w-md"},ae={class:"relative"},le={class:"flex gap-2 flex-wrap"},ne={key:0,class:"border-t border-gray-200 pt-4"},ie={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},oe={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},re={class:"flex items-center justify-between flex-wrap gap-4"},de={class:"flex items-center gap-4"},ce={class:"text-sm font-medium text-blue-900"},ue={class:"flex gap-2"},ge={key:1,class:"bg-white border border-gray-200 rounded-lg text-center py-12"},be={key:2},ve={class:"hidden md:block bg-white border border-gray-200 rounded-lg overflow-hidden"},ye={class:"overflow-x-auto"},he={class:"min-w-full divide-y divide-gray-200"},fe={class:"bg-gray-50"},me={key:0,class:"px-6 py-3 text-left w-12"},pe=["checked"],xe=["onClick"],ke={class:"flex items-center space-x-1"},we={key:0,class:"inline-flex flex-col"},Ce={key:0,class:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},$e={key:1,class:"w-4 h-4 text-blue-600 transform rotate-180",fill:"currentColor",viewBox:"0 0 20 20"},Be={key:2,class:"w-4 h-4 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20"},Me={key:1,class:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider"},ze={class:"bg-white divide-y divide-gray-200"},Se=["onClick","onDblclick"],je=["checked","onChange"],Fe={key:1,class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Te={class:"md:hidden space-y-3"},Ae=["onClick"],De={key:0,class:"mb-3 pb-3 border-b border-gray-200"},Le=["checked","onChange"],Ee={class:"space-y-2"},Ve={class:"text-xs font-medium text-gray-500 uppercase"},Ne={class:"text-sm text-gray-900 mt-1"},He={key:1,class:"mt-4 pt-4 border-t border-gray-200 flex gap-2"},Ie={key:3,class:"bg-white border border-gray-200 rounded-lg text-center py-12"},Oe={key:4,class:"bg-white border border-gray-200 rounded-lg px-4 py-3 sm:px-6"},Pe={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Re={class:"flex flex-1 justify-between sm:hidden"},Ke=["disabled"],Ue=["disabled"],qe={class:"inline-flex items-center px-3 py-2 text-sm text-gray-700"},Qe=["disabled"],Xe=["disabled"],Ge={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Je={class:"flex items-center gap-4"},We={class:"text-sm text-gray-700"},Ye={class:"font-medium"},Ze={class:"font-medium"},_e={class:"font-medium"},et={class:"flex items-center gap-2"},tt={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},st=["disabled"],at=["disabled"],lt=["onClick"],nt=["disabled"],it=["disabled"],dt=Q({__name:"DataTable",props:{columns:{},data:{},loading:{type:Boolean,default:!1},pagination:{},selectable:{type:Boolean,default:!1},hasFilters:{type:Boolean,default:!1}},emits:["row-click","page-change","search","sort","selection-change","refresh","apply-filters","clear-filters"],setup(s,{expose:c,emit:j}){const v=s,b=j,M=f(),z=f(""),m=f(""),h=f("asc"),d=f([]),r=f(!1);let k=null;const O=D(()=>{if(!v.pagination)return[];const{page:l,total_pages:t}=v.pagination,a=[],y=5;let o=Math.max(1,l-Math.floor(y/2));const T=Math.min(t,o+y-1);T-o<y-1&&(o=Math.max(1,T-y+1));for(let A=o;A<=T;A++)a.push(A);return a});function P(){k&&clearTimeout(k),k=setTimeout(()=>{b("search",z.value)},300)}function R(l){v.columns.find(a=>a.key===l)?.sortable!==!1&&(m.value===l?h.value==="asc"?h.value="desc":h.value==="desc"&&(m.value="",h.value="asc"):(m.value=l,h.value="asc"),m.value?b("sort",m.value,h.value):b("refresh"))}function p(l){b("page-change",l)}function L(){b("refresh")}function K(){r.value=!r.value}function U(){b("apply-filters")}function q(){b("clear-filters")}const E=D(()=>v.data&&v.data.length>0&&d.value.length===v.data.length);function S(l){return d.value.some(t=>t.id===l.id)}function V(l){const t=d.value.findIndex(a=>a.id===l.id);t>-1?d.value.splice(t,1):d.value.push(l),b("selection-change",d.value)}function N(){E.value?d.value=[]:d.value=[...v.data],b("selection-change",d.value)}function F(){d.value=[],b("selection-change",[])}function H(l){if(l.key==="F5")l.preventDefault(),L();else if(l.ctrlKey&&l.key==="f")l.preventDefault(),M.value?.focus();else if(l.ctrlKey&&l.key==="a"&&v.selectable){const t=document.activeElement;t?.tagName!=="INPUT"&&t?.tagName!=="TEXTAREA"&&(l.preventDefault(),N())}else l.key==="Escape"&&(d.value.length>0?F():r.value&&(r.value=!1))}return X(()=>v.data,()=>{d.value=[]}),G(()=>{window.addEventListener("keydown",H)}),J(()=>{window.removeEventListener("keydown",H),k&&clearTimeout(k)}),c({clearSelection:F,focusSearch:()=>M.value?.focus()}),(l,t)=>(i(),n("div",_,[e("div",ee,[e("div",te,[e("div",se,[e("div",ae,[W(e("input",{ref_key:"searchInput",ref:M,"onUpdate:modelValue":t[0]||(t[0]=a=>z.value=a),type:"text",placeholder:"Быстрый поиск...",class:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onInput:P},null,544),[[Y,z.value]]),t[10]||(t[10]=e("svg",{class:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),e("div",le,[s.hasFilters?(i(),n("button",{key:0,onClick:K,class:C(["inline-flex items-center px-3 py-2 border text-sm font-medium rounded-md",r.value?"border-blue-500 text-blue-700 bg-blue-50":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50"])},[t[11]||(t[11]=e("svg",{class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)),w(" "+g(r.value?"Скрыть отборы":"Показать отборы"),1)],2)):u("",!0),e("button",{onClick:L,class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",title:"Обновить (F5)"},[...t[12]||(t[12]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])]),x(l.$slots,"header-actions")])]),s.hasFilters&&r.value?(i(),n("div",ne,[e("div",ie,[x(l.$slots,"filters")]),e("div",{class:"mt-4 flex gap-2"},[e("button",{onClick:U,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"}," Применить "),e("button",{onClick:q,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Очистить ")])])):u("",!0)]),d.value.length>0?(i(),n("div",oe,[e("div",re,[e("div",de,[e("span",ce," Выбрано: "+g(d.value.length),1),e("button",{onClick:F,class:"text-sm text-blue-700 hover:text-blue-900 underline"}," Снять выделение ")]),e("div",ue,[x(l.$slots,"bulk-actions",{selected:d.value})])])])):u("",!0),s.loading?(i(),n("div",ge,[...t[13]||(t[13]=[e("div",{class:"inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-3 text-sm text-gray-600"},"Загрузка данных...",-1)])])):s.data&&s.data.length>0?(i(),n("div",be,[e("div",ve,[e("div",ye,[e("table",he,[e("thead",fe,[e("tr",null,[s.selectable?(i(),n("th",me,[e("input",{type:"checkbox",checked:E.value,onChange:N,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer",title:"Выбрать все на странице"},null,40,pe)])):u("",!0),(i(!0),n($,null,B(s.columns,a=>(i(),n("th",{key:a.key,style:Z(a.width?{width:a.width}:{}),class:C(["px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",a.sortable!==!1?"cursor-pointer hover:bg-gray-100 select-none":""]),onClick:y=>R(a.key)},[e("div",ke,[e("span",null,g(a.label),1),a.sortable!==!1?(i(),n("span",we,[m.value===a.key&&h.value==="asc"?(i(),n("svg",Ce,[...t[14]||(t[14]=[e("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"},null,-1)])])):m.value===a.key&&h.value==="desc"?(i(),n("svg",$e,[...t[15]||(t[15]=[e("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"},null,-1)])])):(i(),n("svg",Be,[...t[16]||(t[16]=[e("path",{d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"},null,-1)])]))])):u("",!0)])],14,xe))),128)),l.$slots.actions?(i(),n("th",Me," Действия ")):u("",!0)])]),e("tbody",ze,[(i(!0),n($,null,B(s.data,(a,y)=>(i(),n("tr",{key:a.id||y,class:C(["transition-colors",y%2===0?"bg-white":"bg-gray-50","hover:bg-blue-50",s.selectable?"":"cursor-pointer",S(a)?"bg-blue-100 hover:bg-blue-100":""]),onClick:o=>s.selectable?null:l.$emit("row-click",a),onDblclick:o=>l.$emit("row-click",a)},[s.selectable?(i(),n("td",{key:0,class:"px-6 py-4 whitespace-nowrap",onClick:t[1]||(t[1]=I(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:S(a),onChange:o=>V(a),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"},null,40,je)])):u("",!0),(i(!0),n($,null,B(s.columns,o=>(i(),n("td",{key:o.key,class:C(["px-6 py-4 text-sm text-gray-900",o.key==="number"||o.key==="code"?"whitespace-nowrap":""])},[x(l.$slots,`cell-${o.key}`,{row:a,value:a[o.key]},()=>[w(g(a[o.key]??"—"),1)])],2))),128)),l.$slots.actions?(i(),n("td",Fe,[x(l.$slots,"actions",{row:a})])):u("",!0)],42,Se))),128))])])])]),e("div",Te,[(i(!0),n($,null,B(s.data,(a,y)=>(i(),n("div",{key:a.id||y,class:C(["bg-white border border-gray-200 rounded-lg p-4 cursor-pointer transition-shadow",S(a)?"ring-2 ring-blue-500 bg-blue-50":"hover:shadow-md"]),onClick:o=>l.$emit("row-click",a)},[s.selectable?(i(),n("div",De,[e("input",{type:"checkbox",checked:S(a),onChange:I(o=>V(a),["stop"]),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"},null,40,Le)])):u("",!0),e("div",Ee,[(i(!0),n($,null,B(s.columns,o=>(i(),n("div",{key:o.key},[e("div",Ve,g(o.label),1),e("div",Ne,[x(l.$slots,`cell-${o.key}`,{row:a,value:a[o.key]},()=>[w(g(a[o.key]??"—"),1)])])]))),128))]),l.$slots.actions?(i(),n("div",He,[x(l.$slots,"actions",{row:a})])):u("",!0)],10,Ae))),128))])])):u("",!0),!s.loading&&(!s.data||s.data.length===0)?(i(),n("div",Ie,[...t[17]||(t[17]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),e("p",{class:"mt-4 text-sm text-gray-500"},"Нет данных для отображения",-1),e("p",{class:"mt-1 text-xs text-gray-400"},"Попробуйте изменить параметры поиска или создать новую запись",-1)])])):u("",!0),s.pagination?(i(),n("div",Oe,[e("div",Pe,[e("div",Re,[e("button",{onClick:t[2]||(t[2]=a=>p(1)),disabled:s.pagination.page===1,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Первая ",8,Ke),e("button",{onClick:t[3]||(t[3]=a=>p(s.pagination.page-1)),disabled:s.pagination.page===1,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Назад ",8,Ue),e("span",qe,g(s.pagination.page)+" / "+g(s.pagination.total_pages),1),e("button",{onClick:t[4]||(t[4]=a=>p(s.pagination.page+1)),disabled:s.pagination.page===s.pagination.total_pages,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Вперед ",8,Qe),e("button",{onClick:t[5]||(t[5]=a=>p(s.pagination.total_pages)),disabled:s.pagination.page===s.pagination.total_pages,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Последняя ",8,Xe)]),e("div",Ge,[e("div",Je,[e("p",We,[t[18]||(t[18]=w(" Показано ",-1)),e("span",Ye,g((s.pagination.page-1)*s.pagination.page_size+1),1),t[19]||(t[19]=w(" — ",-1)),e("span",Ze,g(Math.min(s.pagination.page*s.pagination.page_size,s.pagination.total_items)),1),t[20]||(t[20]=w(" из ",-1)),e("span",_e,g(s.pagination.total_items),1),w(" "+g(s.pagination.total_items===1?"записи":(s.pagination.total_items<5,"записей")),1)]),x(l.$slots,"page-size-selector")]),e("div",et,[e("nav",tt,[e("button",{onClick:t[6]||(t[6]=a=>p(1)),disabled:s.pagination.page===1,class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Первая страница"},[...t[21]||(t[21]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})],-1)])],8,st),e("button",{onClick:t[7]||(t[7]=a=>p(s.pagination.page-1)),disabled:s.pagination.page===1,class:"relative inline-flex items-center px-2 py-2 text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Предыдущая страница"},[...t[22]||(t[22]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)])],8,at),(i(!0),n($,null,B(O.value,a=>(i(),n("button",{key:a,onClick:y=>p(a),class:C([a===s.pagination.page?"z-10 bg-blue-600 text-white focus:z-20":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:outline-none"])},g(a),11,lt))),128)),e("button",{onClick:t[8]||(t[8]=a=>p(s.pagination.page+1)),disabled:s.pagination.page===s.pagination.total_pages,class:"relative inline-flex items-center px-2 py-2 text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Следующая страница"},[...t[23]||(t[23]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z","clip-rule":"evenodd"})],-1)])],8,nt),e("button",{onClick:t[9]||(t[9]=a=>p(s.pagination.total_pages)),disabled:s.pagination.page===s.pagination.total_pages,class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-700 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"Последняя страница"},[...t[24]||(t[24]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"})],-1)])],8,it)])])])])])):u("",!0)]))}});export{dt as _,rt as u};
